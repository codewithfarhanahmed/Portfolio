<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Farhan Ahmed | Portfolio</title>
  <meta name="description" content="Farhan Ahmed - Designer, Developer & SAP enthusiast. Portfolio with 3D wireframe globe background." />

  <style>
    /* ================= GOOGLE FONT ================= */
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;700&display=swap');

    /* ================= RESET ================= */
    *,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family:'Poppins',sans-serif;
      color:#111;
      background: linear-gradient(180deg, #0b0011 0%, #0b001f 100%); /* deep base */
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      overflow-y:auto;
      scroll-behavior:smooth;
      line-height:1.4;
    }

    /* ================= THEME COLORS (pink/purple gradient) ================= */
    /* primary gradient: from magenta to purple */
    :root{
      --accent-start: #ff5aa3; /* pink */
      --accent-end: #8a4dff;   /* purple */
      --accent-mid: #ff73c9;
      --muted: rgba(255,255,255,0.08);
      --text-strong: #ffffff;
      --card-bg: rgba(255,255,255,0.03);
    }

    /* ================= CANVAS BACKGROUND ================= */
    #bg-canvas {
      position: fixed;
      inset: 0;
      width: 100%;
      height: 100%;
      z-index: -2; /* always behind content */
      display: block;
      pointer-events: none;
      background: radial-gradient(ellipse at center, rgba(20,8,28,0.40), rgba(4,2,8,0.8));
    }
    /* subtle vignette for depth */
    .bg-vignette {
      position: fixed;
      inset: 0;
      z-index: -1;
      pointer-events: none;
      background: radial-gradient(60% 60% at 50% 40%, rgba(255,255,255,0.02), rgba(0,0,0,0.35) 60%);
      mix-blend-mode: overlay;
    }

  #start-screen{
  position:fixed; inset:0;
  display:flex; gap:18px; align-items:center; justify-content:center;
  flex-direction:column; 
  background: linear-gradient(180deg, #000000, #0b001f); /* black to deep purple */
  z-index:10020;
}

    #start-screen .title{
      font-size:26px; font-weight:700; color:#ffffff; letter-spacing:0.2px;
    }
    #start-btn{
      background: linear-gradient(90deg, var(--accent-start), var(--accent-end));
      color:#fff; border:none; padding:14px 30px; border-radius:12px; font-size:18px;
      cursor:pointer; box-shadow:0 18px 48px rgba(138,77,255,0.18);
      transition: transform .18s ease, box-shadow .18s ease;
    }
    #start-btn:hover { transform: translateY(-4px); box-shadow:0 26px 64px rgba(138,77,255,0.22); }

#transition-overlay {
  position: fixed;
  inset: 0;
  z-index: 10019;
  pointer-events: none;
  background: radial-gradient(circle at center, #ff4ecd 0%, #7d4dff 50%, #1a001f 100%);
  transform: scale(0);
  border-radius: 50%;
  opacity: 0;
  box-shadow: 0 0 60px rgba(255, 78, 205, 0.4); /* neon glow */
}

#transition-overlay.active {
  animation: overlayExpand 1.8s forwards cubic-bezier(0.77, 0, 0.175, 1);
}

@keyframes overlayExpand {
  0% {
    transform: scale(0);
    opacity: 1;
    filter: blur(20px);
  }
  30% {
    transform: scale(2.5);
    opacity: 1;
    filter: blur(5px);
  }
  60% {
    transform: scale(5);
    opacity: 0.9;
    filter: blur(15px);
  }
  100% {
    transform: scale(10);
    opacity: 0;
    filter: blur(40px);
  }
}

    /* ================= SCROLL SNAP MAIN ================= */
    main{
      height:100%;
      scroll-snap-type: y mandatory;
      overflow-y:auto;
      position:relative;
      z-index:2; /* content above canvas */
    }
    section{
      min-height:100vh;
      width:100%;
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 64px 28px;
      scroll-snap-align:start;
      position:relative;
    }

    /* ================= NAVBAR ================= */
    nav{
      position:fixed; top:18px; left:20px; right:20px;
      display:flex; justify-content:space-between; align-items:center;
      padding:10px 18px; background: rgba(255,255,255,0.03);
      border-radius:12px; z-index:10010; backdrop-filter: blur(6px);
      box-shadow:0 10px 28px rgba(0,0,0,0.35);
    }
    .logo{ font-weight:700; color:var(--text-strong); letter-spacing:0.4px; font-size:18px }
    nav ul{ list-style:none; display:flex; gap:14px; align-items:center; margin-left:8px }
    nav a{
      color: rgba(255,255,255,0.92); text-decoration:none; font-weight:500;
      padding:6px 8px; border-radius:8px;
      transition: all .18s ease;
    }
    nav a:hover{ background: rgba(255,255,255,0.04); color: var(--accent-start); transform: translateY(-1px); }

    /* ================= HERO ================= */
    .hero-wrap { text-align:center; color:var(--text-strong); padding-top:40px; max-width:1100px; }
    .hero-inner { width:100%; }
    .hero-wrap h1 {
      font-size: clamp(28px, 6vw, 64px);
      font-weight:700; line-height:1.02; margin-bottom:12px;
      text-shadow: 0 8px 36px rgba(0,0,0,0.7);
      background: linear-gradient(90deg, var(--accent-start), var(--accent-end));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    .hero-wrap p {
      font-size: clamp(15px, 2vw, 20px); color: rgba(255,255,255,0.9); margin-bottom:20px;
    }
    #typed-text {
      color: var(--accent-mid); font-weight:600;
      background: linear-gradient(90deg, #ff9ad8, #c285ff);
      -webkit-background-clip: text; background-clip: text; color: transparent;
    }

    .cta-row { margin-top:20px; display:flex; gap:12px; justify-content:center; flex-wrap:wrap; }

    .btn {
      text-decoration: none;
      background: linear-gradient(90deg, var(--accent-start), var(--accent-end));
      color:#fff; border:none; padding:10px 18px; border-radius:10px; font-weight:700; cursor:pointer;
      box-shadow:0 14px 36px rgba(138,77,255,0.12);
      transition: transform .18s ease, box-shadow .18s ease;
    }
    .btn:hover { transform: translateY(-4px); box-shadow:0 20px 56px rgba(138,77,255,0.16); }
    .btn.ghost { background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.02)); color:#fff; border:1px solid rgba(255,255,255,0.04) }

    /* ================= ABOUT ================= */
    .content-card {
      background: var(--card-bg);
      padding: 26px;
      max-width: 960px;
      border-radius: 14px;
      color: #f5f5f7;
      box-shadow: 0 14px 46px rgba(2,0,8,0.6);
      border: 1px solid rgba(255,255,255,0.02);
    }
    .content-card h2 { color: #fff; margin-bottom:10px; font-size:28px; }
    .content-card p { color:#e6e6ea; line-height:1.7 }

    /* ================= PROJECTS CAROUSEL ================= */
    #projects h2 { color:#fff; margin-bottom:14px; font-size:26px; text-align:center }
    .projects-carousel{
      display:flex; gap:18px; overflow-x:auto; padding:18px 8px;
      -webkit-overflow-scrolling:touch; scrollbar-width:none;
    }
    .projects-carousel::-webkit-scrollbar{display:none}
    .project-card{
      min-width:300px; max-width:360px;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:14px; overflow:hidden; color:#fff;
      box-shadow:0 18px 44px rgba(3,6,23,0.6);
      transition: transform .32s ease, box-shadow .32s ease;
      flex-shrink:0;
      border: 1px solid rgba(138,77,255,0.06);
    }
    .project-card img{ width:100%; height:200px; object-fit:cover; display:block }
    .project-card .meta{ padding:12px 14px }
    .project-card h3{ font-size:18px; margin-bottom:6px }
    .project-card p{ color:#dcdce2; font-size:14px }
    .project-card:hover{ transform:translateY(-8px); box-shadow:0 26px 86px rgba(138,77,255,0.16) }

    /* ================= GALLERY ================= */
    #gallery h2 { color:#fff; margin-bottom:14px; font-size:26px; text-align:center }
    .gallery-grid{
      display:grid; grid-template-columns: repeat(auto-fit, minmax(220px,1fr)); gap:16px; width:100%;
    }
    .gallery-grid-item{ border-radius:10px; overflow:hidden; position:relative; box-shadow:0 12px 32px rgba(0,0,0,0.55) }
    .gallery-grid-item img{ width:100%; height:260px; object-fit:cover; transition:transform .45s ease; display:block }
    .gallery-grid-item:hover img{ transform:scale(1.05) }
    .gallery-overlay{ position:absolute; left:0; right:0; bottom:0; padding:10px 12px; color:#fff; background:linear-gradient(to top, rgba(0,0,0,0.55), transparent); font-weight:700 }

    /* ================= CONTACT/FOOTER ================= */
    footer{ color:#d8d0df; padding:18px; text-align:center }

    /* ================= MUSIC CONTROL ================= */
    .music-control{
      position:fixed; bottom:22px; right:22px; z-index:10008;
      background: linear-gradient(90deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
      color:#fff; padding:8px 12px; border-radius:20px; cursor:pointer; font-weight:600; backdrop-filter:blur(6px);
      border: 1px solid rgba(255,255,255,0.03);
    }

    /* ================= REVEAL ANIMATIONS ================= */
    .reveal{ opacity:0; transform:translateY(18px); transition:all .7s cubic-bezier(.2,.9,.3,1) }
    .reveal.visible{ opacity:1; transform:translateY(0) }

    /* ================= RESPONSIVE ================= */
    @media (max-width:900px){
      nav{ left:12px; right:12px; padding:8px }
      .project-card{ min-width:260px; max-width:300px }
      .gallery-grid-item img{ height:200px }
    }
    @media (max-width:480px){
      .hero-wrap h1{ font-size:28px }
      .hero-wrap p{ font-size:15px }
      .gallery-grid-item img{ height:160px }
      nav ul{ display:none } /* simpler on mobile */
    }
  </style>
</head>
<body>

  <!-- ================= BACKGROUND CANVAS ================= -->
  <canvas id="bg-canvas"></canvas>
  <div class="bg-vignette"></div>

  <!-- ================= START SCREEN ================= -->
  <div id="start-screen" role="dialog" aria-modal="true">
    <div class="title">Welcome!</div>
    <button id="start-btn">View Portfolio</button>
    <div id="transition-overlay" aria-hidden="true"></div>
  </div>

  <!-- ================= AUDIO ================= -->
  <audio id="bg-music" loop preload="auto">
    <source src="music/Cartoon, Jéja - On & On (feat. Daniel Levi) ｜ Electronic Pop ｜ NCS - Copyright Free Music.mp3" type="audio/mpeg">
  </audio>
  <div class="music-control" id="music-control">▶ Play Music</div>

  <!-- ================= NAVBAR ================= -->
  <nav>
    <div style="display:flex; align-items:center; gap:12px;">
      <div class="logo">Farhan Ahmed</div>
      <ul>
        <li><a href="#hero">Home</a></li>
        <li><a href="#about">About</a></li>
        <li><a href="#projects">Projects</a></li>
        <li><a href="#gallery">Gallery</a></li>
        <li><a href="#contact">Contact</a></li>
      </ul>
    </div>
    <div style="display:flex; gap:10px; align-items:center;">
      <a class="btn ghost" href="#projects">View Work</a>
      <a class="btn" href="mailto:farhan.riphah21@gmail.com">Hire Me</a>
    </div>
  </nav>

  <!-- ================= MAIN (SCROLL SNAP) ================= -->
  <main id="main" tabindex="0">
    <!-- HERO -->
    <section id="hero" class="hero-wrap">
      <div class="hero-inner">
       <h1 class="reveal">
  Hi, I'm <span class="glow">Farhan Ahmed</span>
</h1>

<style>
  .glow {
    color: white;
    text-shadow: 
      0 0 5px rgba(255, 255, 255, 0.6),
      0 0 10px rgba(255, 255, 255, 0.4),
      0 0 15px rgba(255, 255, 255, 0.2);
  }
</style>

        <p class="reveal">I am <span id="typed-text"></span></p>
        <div class="cta-row reveal">
          <a class="btn" href="#projects">See Projects</a>
          <a class="btn ghost" href="#contact">Contact Me</a>
        </div>
      </div>
    </section>

    <!-- ABOUT -->
    <section id="about" style="display:flex; align-items:center; justify-content:center;">
      <div class="content-card reveal">
        <h2>About Me</h2>
        <p>
          I'm a Computer Science graduate, Front-end Dev, Associate SAP Business One Consultant, and passionate graphic designer.
          I build creative digital solutions — from responsive websites and branding to AI-assisted design tools.
        </p>
        <p>
      This portfolio itself is a visualization of my skillset and creative thinking as both a designer and a developer.
    </p>

      </div>
    </section>

    <!-- PROJECTS -->
    <section id="projects" style="flex-direction:column; align-items:flex-start;">
      <h2 class="reveal">My Projects</h2>
      <div class="projects-carousel reveal" aria-label="Projects carousel">
        <div class="project-card">
          <img src="images/Savify Brochure.jpg" alt="Savify">
          <div class="meta"><h3>Savify Brochure</h3><p>An AI-Based multi-vendor e-commerce project as my Final year project.</p></div>
        </div>

        <div class="project-card">
          <img src="images/1733347118203.jpg" alt="Branding Showcase">
          <div class="meta"><h3>Job Fair 2025 Visuals</h3><p>Complete visual designs for Job Fair 2025 organized by Riphah International University.</p></div>
        </div>

        <div class="project-card">
          <img src="images/WhatsApp Image 2025-08-21 at 16.10.01.jpeg" alt="Event Poster">
          <div class="meta"><h3>Event Poster</h3><p>Poster and social assets for university sports event.</p></div>
        </div>

        <div class="project-card">
          <img src="images/1730016548182.jpg" alt="Logo Concept">
          <div class="meta"><h3>Logo Concept</h3><p>Logo explorations for several small business clients.</p></div>
        </div>

        <div class="project-card">
          <img src="images/Job Fair 2.jpg" alt="Job Fair Campaign">
          <div class="meta"><h3>Job Fair Campaign</h3><p>Posters, banners and online creatives for career fair.</p></div>
        </div>
      </div>
    </section>

    <!-- GALLERY -->
    <section id="gallery" style="flex-direction:column; align-items:flex-start;">
      <h2 class="reveal">Gallery</h2>
      <div class="gallery-grid reveal">
        <div class="gallery-grid-item" style="position:relative;">
          <img src="images/Savify Brochure.jpg" alt="Savify Brochure gallery">
          <div class="gallery-overlay">Savify Brochure</div>
        </div>
        <div class="gallery-grid-item" style="position:relative;">
          <img src="images/1733347118203.jpg" alt="Branding showcase gallery">
          <div class="gallery-overlay">Branding Showcase</div>
        </div>
        <div class="gallery-grid-item" style="position:relative;">
          <img src="images/WhatsApp Image 2025-08-21 at 16.10.01.jpeg" alt="Event poster gallery">
          <div class="gallery-overlay">Event Poster</div>
        </div>
        <div class="gallery-grid-item" style="position:relative;">
          <img src="images/1730016548182.jpg" alt="Logo concept gallery">
          <div class="gallery-overlay">Logo Concept</div>
        </div>
        <div class="gallery-grid-item" style="position:relative;">
          <img src="images/Job Fair 2.jpg" alt="Job fair gallery">
          <div class="gallery-overlay">Job Fair Campaign</div>
        </div>
      </div>
    </section>

    <!-- CONTACT -->
    <div class="social-links">
  <a href="https://www.linkedin.com/in/farhan-ahmed-39732223b?" target="_blank">
    <img src="images/linkedin.png" alt="LinkedIn">
  </a>
  <a href="https://github.com/codewithfarhanahmed" target="_blank">
    <img src="images/git.png" alt="GitHub">
  </a>
  <a href="mailto:farhan.riphah21@gmail.com">
    <img src="images/gmail.png" alt="Email">
  </a>
</div>


    <!-- FOOTER -->
    <section style="min-height:auto; padding:32px 24px;">
      <footer class="reveal">Created and Updated by Farhan Ahmed - 11/09/2025</footer>
    </section>
  </main>

  <!-- ================= THREE.JS (wireframe globe + network, pink/purple theme) ================= -->
  <script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
  <script>
  /* ================= Helper & UI: Start screen, Music, Typing, Carousel, Reveal ================= */
  const startScreen = document.getElementById('start-screen');
  const startBtn = document.getElementById('start-btn');
  const transitionOverlay = document.getElementById('transition-overlay');
  const mainEl = document.getElementById('main');
  const music = document.getElementById('bg-music');
  const musicControl = document.getElementById('music-control');

  function fadeInMusic(){
    try{
      music.volume = 0;
      const step = 0.02;
      const timer = setInterval(()=>{
        music.volume = Math.min(music.volume + step, 1);
        if(music.volume >= 1) clearInterval(timer);
      }, 60);
    } catch(e){}
  }

  startBtn.addEventListener('click', ()=>{
    transitionOverlay.classList.add('active');
    setTimeout(()=>{
      startScreen.style.display = 'none';
      mainEl.style.display = 'block';
      // attempt to play music (user gesture)
      music.play().then(()=>fadeInMusic()).catch(()=>{});
      musicControl.textContent = '⏸ Pause Music';
    }, 900);
  });

  musicControl.addEventListener('click', ()=>{
    if(music.paused){
      music.play().then(()=>fadeInMusic()).catch(()=>{});
      musicControl.textContent = '⏸ Pause Music';
    } else {
      music.pause();
      musicControl.textContent = '▶ Play Music';
    }
  });

  // Typing effect
  const phrases = ["a Graphics Designer.", "a Front-End Developer.", "a Creative Thinker.", "a Visual Storyteller.", "Associate Sap Business One Consultant."];
  const typedText = document.getElementById('typed-text');
  let pIndex = 0, chIndex = 0, deleting = false;
  const typeSpeed = 90;
  function typeLoop(){
    const full = phrases[pIndex];
    if(!deleting){
      chIndex++;
      typedText.textContent = full.slice(0,chIndex);
      if(chIndex === full.length){
        deleting = true;
        setTimeout(typeLoop, 1200);
        return;
      }
    } else {
      chIndex--;
      typedText.textContent = full.slice(0,chIndex);
      if(chIndex === 0){
        deleting = false;
        pIndex = (pIndex + 1) % phrases.length;
      }
    }
    setTimeout(typeLoop, typeSpeed);
  }
  document.addEventListener('DOMContentLoaded', ()=>setTimeout(typeLoop, 400));

  // Reveal on scroll
  const revealEls = document.querySelectorAll('.reveal');
  const revealObserver = new IntersectionObserver((entries)=>{
    entries.forEach(e => { if(e.isIntersecting) e.target.classList.add('visible'); });
  }, { threshold: 0.18 });
  revealEls.forEach(el => revealObserver.observe(el));

  // Carousel drag
  (function initCarouselDrag(){
    const carousel = document.querySelector('.projects-carousel');
    if(!carousel) return;
    let isDown=false, startX, scrollLeft;
    carousel.addEventListener('mousedown', e => {
      isDown = true; startX = e.pageX - carousel.offsetLeft; scrollLeft = carousel.scrollLeft;
      carousel.style.cursor = 'grabbing';
    });
    window.addEventListener('mouseup', ()=>{ isDown=false; carousel.style.cursor = 'grab'; });
    carousel.addEventListener('mousemove', e => {
      if(!isDown) return;
      e.preventDefault();
      const x = e.pageX - carousel.offsetLeft;
      const walk = (x - startX) * 1.6;
      carousel.scrollLeft = scrollLeft - walk;
    });

    // touch
    let tStartX=0, tScrollLeft=0;
    carousel.addEventListener('touchstart', e => { tStartX = e.touches[0].pageX - carousel.offsetLeft; tScrollLeft = carousel.scrollLeft; }, {passive:true});
    carousel.addEventListener('touchmove', e => { const x = e.touches[0].pageX - carousel.offsetLeft; const walk = (x - tStartX) * 1.3; carousel.scrollLeft = tScrollLeft - walk; }, {passive:true});
  })();

  /* ================= THREE.JS: Wireframe Globe + Network (pink/purple theme) ================= */
  (function globeInit(){
    const canvas = document.getElementById('bg-canvas');
    if(!canvas) return;

    // Renderer
    const renderer = new THREE.WebGLRenderer({ canvas, antialias:true, alpha:true });
    renderer.setPixelRatio(window.devicePixelRatio || 1);
    renderer.setSize(window.innerWidth, window.innerHeight);
    renderer.outputEncoding = THREE.sRGBEncoding;

    // Scene & Camera
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(50, window.innerWidth/window.innerHeight, 0.1, 1000);
    camera.position.z = 28;
    camera.position.y = 0;

    // Lighting (very subtle; lighting mostly simulated by material/emissive)
    scene.add(new THREE.AmbientLight(0xffffff, 0.18));
    const pl = new THREE.PointLight(0xffffff, 0.28);
    pl.position.set(50, 20, 50);
    scene.add(pl);

    /* ---------- Wireframe globe (edge-style) ---------- */
    const globeRadius = 7.2;
    const widthSeg = 64;
    const heightSeg = 48;
    const sphereGeo = new THREE.SphereGeometry(globeRadius, widthSeg, heightSeg);

    // Create edges geometry for a crisp wireframe look
    const edgesGeo = new THREE.EdgesGeometry(sphereGeo, 1);
    // Use LineSegments with a glowing-like material (pink/purple)
    const lineMaterial = new THREE.LineBasicMaterial({ color: 0xff73c9, linewidth: 1, transparent: true, opacity: 0.96 });
    const wireframe = new THREE.LineSegments(edgesGeo, lineMaterial);
    wireframe.renderOrder = 2;
    scene.add(wireframe);

    // Add a second slightly-offset wireframe with different color/opacity for depth
    const edgesGeo2 = new THREE.EdgesGeometry(new THREE.SphereGeometry(globeRadius * 1.001, widthSeg, heightSeg));
    const lineMaterial2 = new THREE.LineBasicMaterial({ color: 0xb78aff, linewidth: 1, transparent: true, opacity: 0.18 });
    const wireframe2 = new THREE.LineSegments(edgesGeo2, lineMaterial2);
    scene.add(wireframe2);

    /* ---------- Network points on the globe surface ---------- */
    const networkCount = 260; // number of nodes on sphere surface
    const nodePositions = [];
    const nodes = new Float32Array(networkCount * 3);
    const nodeColors = new Float32Array(networkCount * 3);

    // Utility to convert spherical coords to cartesian
    function sphericalToCartesian(r, theta, phi){
      const x = r * Math.cos(phi) * Math.cos(theta);
      const y = r * Math.sin(phi);
      const z = r * Math.cos(phi) * Math.sin(theta);
      return [x,y,z];
    }

    // Generate node positions (roughly uniformly distributed)
    for(let i=0;i<networkCount;i++){
      const t = i / networkCount;
      const phi = Math.acos(1 - 2 * t) - Math.PI/2; // polar
      const theta = Math.PI * (1 + Math.sqrt(5)) * i; // azimuth
      const jitter = (Math.random() - 0.5) * 0.12; // small jitter
      const r = globeRadius + 0.02 + jitter;
      const [x,y,z] = sphericalToCartesian(r, theta, phi);
      nodePositions.push(new THREE.Vector3(x,y,z));

      nodes[i*3] = x;
      nodes[i*3+1] = y;
      nodes[i*3+2] = z;

      // color nodes in pink/purple palette
      const rr = 1.0;
      const gg = 0.6 + Math.random() * 0.25;
      const bb = 0.9 + Math.random() * 0.12;
      nodeColors[i*3] = rr;
      nodeColors[i*3+1] = gg;
      nodeColors[i*3+2] = bb;
    }

    // Create points material (glowing dot using PointsMaterial)
    const nodeMat = new THREE.PointsMaterial({
      size: 0.12 * (window.devicePixelRatio || 1),
      vertexColors: false,
      color: 0xff9ad8,
      transparent: true,
      opacity: 0.98,
      depthWrite: false,
      blending: THREE.AdditiveBlending
    });
    const nodesGeo = new THREE.BufferGeometry();
    nodesGeo.setAttribute('position', new THREE.BufferAttribute(nodes, 3));
    nodesGeo.setAttribute('color', new THREE.BufferAttribute(nodeColors, 3));
    const nodePoints = new THREE.Points(nodesGeo, nodeMat);
    nodePoints.renderOrder = 3;
    scene.add(nodePoints);

    /* ---------- Network lines: connect nearby nodes (k-nearest style) ---------- */
    const linksPerNode = 3;
    const maxLinkDistance = 3.6; // tweak - how far lines can reach
    const linePositions = [];
    const lineColors = [];

    for(let i=0;i<networkCount;i++){
      const dists = [];
      for(let j=0;j<networkCount;j++){
        if(i===j) continue;
        const d = nodePositions[i].distanceTo(nodePositions[j]);
        dists.push({ idx:j, d });
      }
      dists.sort((a,b)=>a.d - b.d);
      for(let k=0;k<linksPerNode;k++){
        const neighbor = dists[k];
        if(!neighbor) continue;
        if(neighbor.d > maxLinkDistance) continue;

        const p1 = nodePositions[i];
        const p2 = nodePositions[neighbor.idx];

        linePositions.push(p1.x, p1.y, p1.z);
        linePositions.push(p2.x, p2.y, p2.z);

        // color (pinkish-blue gradient values)
        lineColors.push(0.9, 0.6, 1.0);
        lineColors.push(0.9, 0.6, 1.0);
      }
    }

    const linkGeom = new THREE.BufferGeometry();
    const lp = new Float32Array(linePositions);
    const lc = new Float32Array(lineColors);
    linkGeom.setAttribute('position', new THREE.BufferAttribute(lp, 3));
    linkGeom.setAttribute('color', new THREE.BufferAttribute(lc, 3));
    const linkMat = new THREE.LineBasicMaterial({
      vertexColors: true,
      transparent: true,
      opacity: 0.16,
      linewidth: 1,
      blending: THREE.AdditiveBlending
    });
    const linkLines = new THREE.LineSegments(linkGeom, linkMat);
    linkLines.renderOrder = 1;
    scene.add(linkLines);

    /* ---------- Atmospheric glow: subtle sprite + halo ---------- */
    const spriteMap = new THREE.TextureLoader().load("https://cdn.jsdelivr.net/gh/mrdoob/three.js@r152/examples/textures/sprites/disc.png");
    const haloMat = new THREE.SpriteMaterial({ map: spriteMap, color: 0xff8acc, opacity: 0.06, blending: THREE.AdditiveBlending });
    const halo = new THREE.Sprite(haloMat);
    halo.scale.set(globeRadius * 5.0, globeRadius * 5.0, 1.0);
    scene.add(halo);

    /* ---------- Interaction & animation ---------- */
    let mouseX = 0, mouseY = 0;
    window.addEventListener('mousemove', (e)=>{
      mouseX = (e.clientX / window.innerWidth) * 2 - 1;
      mouseY = (e.clientY / window.innerHeight) * 2 - 1;
    });

    // scroll-based parallax
    let targetScroll = 0, scrollPos = 0;
    window.addEventListener('scroll', ()=> {
      targetScroll = window.scrollY / (document.body.scrollHeight - window.innerHeight || 1);
    }, {passive:true});

    // animate
    let baseRotation = 0;
    function animate(){
      requestAnimationFrame(animate);

      // smooth scroll interpolation
      scrollPos += (targetScroll - scrollPos) * 0.06;

      // base rotation speed (slows on top, slightly faster when scrolled down)
      const speed = 0.0009 + scrollPos * 0.0035;
      baseRotation += speed;

      // wireframes rotate
      wireframe.rotation.y = baseRotation * 0.75;
      wireframe.rotation.x = Math.sin(baseRotation * 0.12) * 0.02;
      wireframe.rotation.z = Math.cos(baseRotation * 0.07) * 0.03;

      wireframe2.rotation.y = baseRotation * 0.76;
      wireframe2.rotation.x = wireframe.rotation.x * 0.98;
      wireframe2.rotation.z = wireframe.rotation.z * 1.02;

      // nodes and links rotate slightly differently for depth
      nodePoints.rotation.y = baseRotation * 0.78;
      nodePoints.rotation.x = Math.sin(baseRotation * 0.08) * 0.01;

      linkLines.rotation.y = baseRotation * 0.77;
      linkLines.rotation.x = Math.sin(baseRotation * 0.06) * 0.012;

      // subtle parallax camera move with mouse
      camera.position.x += (mouseX * 6 - camera.position.x) * 0.04;
      camera.position.y += (-mouseY * 4 - camera.position.y) * 0.03;

      // zoom slightly on scroll
      camera.position.z = 28 - scrollPos * 8;

      // nodes subtle pulse
      const t = performance.now() * 0.002;
      nodeMat.size = 0.10 + Math.sin(t) * 0.02 * (window.devicePixelRatio || 1);

      renderer.render(scene, camera);
    }
    animate();

    // responsive
    window.addEventListener('resize', ()=>{
      renderer.setSize(window.innerWidth, window.innerHeight);
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
    });

  })(); // globeInit end
  </script>
</body>
</html>
